<!DOCTYPE HTML>
<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><TITLE>HELP EDES-LABELS</TITLE>
<LINK REL="stylesheet" HREF="edes.php?R:$h/i/label.css" TYPE="text/css">
</HEAD>
<BODY style='margin:0px' scroll=no oncontextmenu='return false;' onhelp='return false'><!-- [HelpIni] --><table id="Esquema" width="100%" cellspacing="1px" cellpadding="2px">
<tbody>
<tr style="position: relative;">
<td id="Etiqueta">PDFLabel</td>
</tr>
<tr>
<td id="tSintaxis">SINTAXIS</td>
</tr>
<tr>
<td id="Sintaxis">[PDFLabel] NomFile | OffsetX,OffsetY | Ancho,Alto | MargenRight,MargenBottom | NEtiPorLinea,NEtiPorColumna [ | AltoLetra [ |TipoLetra [[ | NomFunctionUsu | padding ]]]]<br />...</td>
</tr>
<tr>
<td id="tDescripcion">DESCRIPCION</td>
</tr>
<tr>
<td id="Descripcion">Generación de etiquetas, fichas y sobres en formato PDF. Tener en cuenta que si se quiere pintar la parte visible de un select como por ejemplo "cd_via" habrá que poner "nm_via".<br />Para empezar a imprimir en una etiqueta determinada usar las variables "<span style="font-size: small;">_PDFLabelCol" y "</span><span style="font-size: small;">_PDFLabelRow" siendo la esquina superior izquierda el 0,0.<br />Desde la generación de PDF de puede imprimir el código de barras EAN-13.</span></td>
</tr>
<tr>
<td id="tParametro">PARAMETROS</td>
</tr>
<tr>
<td id="Parametro">
<p><strong>NomFile</strong>: Nombre del fichero a generar, si ponemos la palabra "label" sacará una página de etiquetas rellenas con números como muestra, si se deja en blanco el nombre del fichero será automático generandose en "/_tmp/pdf/", si ponemos un nombre de fichero sin trayectoria se grabará en el mismo directorio, si el nombre va acompañado de un directorio será ahí.<br /><strong>OffsetX,OffsetY</strong>: Distancia de la primera etiqueta al borde superior izquierdo, si se pone un número será la distancia en carácteres y si se pone un número seguido de una "p" será la distancia en puntos.<br /><strong>Ancho,Alto</strong>:<br /><strong>MargenRight,MargenBottom</strong>: Distancia entre etiquetas tambien se puede dar en número de caracteres o en puntos.<br /><strong>NEtiPorLinea,NEtiPorColumna</strong>: <br /><strong>AltoLetra</strong>: <br /><strong>TipoLetra</strong>: El tipo de letra puede se el valor por defecto si no se pone, el nombre completo del tipo de letra o sus inciales siendo el tipo de letra base:<br />C - Courier<br />H - Helvetica<br />T - Times-Roman<br />y se le puede añadir variaciones<br />O - Oblique / I - Italic<br />B - Bold<br />BO - BoldOblique ( OB )<br />BI - BoldItalic ( IB )<br />Ejemplo:<br />HBO - Helvetica-BoldOblique<br />CB - Courier-Bold<br /> <strong>NomFunctionUsu</strong>: A la función de usuario se la mandará 6 parámetros:<br /><u>$p</u>: Puntero del documento PDF.<br /><u>$x</u>: Coordenada "x" de la etiqueta actual.<br /><u>$y:</u> Coordenada "y" de la etiqueta actual.<br /><u>$nRow</u>: Nº de linea de la etiqueta.<br /><u>$nCol</u>: Nº de columna de la etiqueta.<br /><u>$vField</u>: Matriz con el registro a pintar.<br /><br />- Desde la función de usuario se puede llamar a generar el código de barras del tipo EAN-13 de la siguiente forma:<br />eEAN13( CodigoDeBarrasNumerico, AltoBarras, CoordX, CoordY ).<br /><strong>Padding:</strong> top,right,bottom,left - Genera las etiquetas en posición absoluta dividiendo el DINA4 entre el número de etiquetas</p>
</td>
</tr>
<tr>
<td id="tEjemplo">EJEMPLO</td>
</tr>
<tr>
<td id="Ejemplo">
<p>[PDFLabel] NomFile | 10,5 | 40,6 | 2,2 | 3,5<br /><br />// Campo   | x | y | AnchoMax | Obligatorio | Constante<br /><br />nombre     | 3 | 3 || # | " "<br />apellidos  |   |   || # |<br /><br />nm_via     |   | 4 || # | " "<br />direccion  |   |   || # | ", "<br />numero     |   |   || # | ' ('<br />escalera   |   |   ||   | " "<br />piso       |   |   ||   | " "<br />puerta     |   |   ||   | " )"<br /><br />cd_postal  |   | 5 || # | -<br />poblacion  |   |   || # |</p>
<p>En modos: cR,mR,bR si está la etiqueta [PDFLabel] generará las etiquetas<br />Si no hay "Ancho" hará trim()<br />Si no hay "x" pintará a continuación<br />Si no hay "y" pintará en la misma linea<br />Si no hay "campo" pintará una constante</p>
</td>
</tr>
<tr>
<td id="txt"> </td>
</tr>
<tr>
<td id="tEjemplo">EJEMPLO</td>
</tr>
<tr>
<td id="Ejemplo">[PDFVar] PDF_Width  = 300                             //Ancho del sobre<br />[PDFVar] PDF_Height = 100                             //Alto del sobre<br /><br />[PDFLabel] NomFile | 10,5 | 40,6 | 2,2 | 1,1<br /><br />// Campo   | x | y | AnchoMax | Obligatorio | Constante<br /><br />nombre     | 3 | 3 || # | " "<br />apellidos  |   |   || # |<br /><br />nm_via     |   | 4 || # | " "<br />direccion  |   |   || # | ", "<br />numero     |   |   || # | ' ('<br />escalera   |   |   ||   | " "<br />piso       |   |   ||   | " "<br />puerta     |   |   ||   | " )"<br /><br />cd_postal  |   | 5 || # | -<br />poblacion  |   |   || # |</td>
</tr>
<tr>
<td id="txt">Para imprimir sobres solo hay que definir un tamaño distinto de papel y una etiqueta por página</td>
</tr>
</tbody>
</table><!-- [HelpEnd] -->
<SCRIPT LANGUAGE="JavaScript">
Esquema.cellSpacing = 0;
if( Ejemplo.length==undefined && Ejemplo.innerHTML.length==0 ){
	tEjemplo.parentElement.style.display = 'none';
}else{
	for(var i=0; i<Ejemplo.length; i++){
		if( Ejemplo[i].innerHTML.length==0 ) Ejemplo[i].parentElement.style.display = 'none';
	}
}
if( Parametro.innerHTML.length==0 ) tParametro.parentElement.style.display = 'none';
if( window.frameElement.getAttribute("eSubWin")==1 ) Etiqueta.style.display = "none";
window.focus();
</SCRIPT>
</BODY></HTML>